import{a7 as d,r as h,j as e,a8 as S,a9 as y,N as v,B as k,aa as E,P as b,f as B,ab as A,c as F,d as U,ac as M,ad as w}from"./vendor-WQejLG7Y.js";import{u as P,l as N}from"./index-BUY2Cjej.js";import{U as q,a as I}from"./background-Dbg_7zdz.js";const L=({onLoginSuccess:m,emailLogin:p})=>{const u=P(s=>s.getProfile),[n]=d.useForm(),[j,o]=h.useState(!1),[i,g]=h.useState(),t=async s=>{if(s.error)return;o(!0);const a=await N.loginWithGoogle(s.credential);l(a)},l=async s=>{var x,r;const a=await u((r=(x=s==null?void 0:s.data)==null?void 0:x.tokenData)==null?void 0:r.token);s.data.isBusinessMember=a==null?void 0:a.isUsingBusinessProfile,m(s),o(!1)},c=async s=>{o(!0);try{const{email:a,password:x}=s,r=await N.doLogin(a,x),f=await u(r.data.tokenData.token);r.data.isBusinessMember=f==null?void 0:f.isUsingBusinessProfile,m(r,f)}catch(a){a.response?g(a.response.data.message):g(window.navigator.onLine?"Your email or password is incorrect. Please try again":"Looks like you are offline. Please check your internet connection and try again")}o(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(d,{onFinish:c,form:n,name:"login",layout:"vertical",initialValues:{email:p||""},requiredMark:!1,children:[i&&e.jsx(S,{className:"mb-4 w-[400px]",message:i,type:"error"}),e.jsx(d.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email address!"}],children:e.jsx(y,{size:"large",placeholder:"Enter your email...",className:"w-[400px]"})}),e.jsx(d.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please enter your Password!"}],children:e.jsx(y,{size:"large",type:"password",placeholder:"Enter your password...",className:"w-[400px]"})}),e.jsxs(d.Item,{children:[e.jsx(v,{className:"float-right text-xs relative top-[-20px] font-semibold",to:"/forgot-password",children:"Forgot password?"}),e.jsx(k,{type:"primary",htmlType:"submit",loading:j,block:!0,children:"Log in"})]})]}),e.jsxs("div",{className:"flex items-center my-6",children:[e.jsx("hr",{className:"flex-grow border-slate-50 border-t-1"}),e.jsx("span",{className:"px-2",children:"Or"}),e.jsx("hr",{className:"flex-grow border-slate-50 border-t-1"})]}),e.jsx("center",{className:"flex justify-center items-center",children:e.jsx(E,{onSuccess:t,type:"icon",shape:"rectangular",text:"signin"})})]})};L.propTypes={onLoginSuccess:b.func.isRequired,emailLogin:b.string};function T(){const{connect:m}=B(),[p]=A(),u=p.get("email"),n=F(),{isAuthenticated:j,setAuthenticate:o}=P(t=>t),{address:i}=U();h.useEffect(()=>{if(!i){m();return}},[i]),h.useEffect(()=>{j&&n("/invest")},[]);const g=(t,l)=>{try{if(t.status>0){const{data:{hasSubmittedProfile:c}}=t;o(t==null?void 0:t.data),l!=null&&l.businessProfile?n(c?"/pool":"/profile/verify"):n("/sign-up/complete")}}catch(c){console.log(c)}};return e.jsxs(M,{className:"h-screen",children:[e.jsxs(w,{lg:8,md:0,xs:0,className:"flex justify-center relative",children:[e.jsx("img",{src:q,alt:"side_bg_untangle",className:"w-full h-full object-cover"}),e.jsx("img",{src:I,alt:"side_logo_untangle",className:"absolute top-[100px]"})]}),e.jsx(w,{lg:16,md:24,xs:24,children:e.jsxs("div",{className:"h-screen flex flex-col justify-center items-center",children:[e.jsxs("div",{"data-testid":"login-form-container",className:"pb-6",children:[e.jsx("div",{className:"text-4xl pb-6 font-bold",children:"Login to Untangled"}),e.jsx("div",{"data-testid":"login-form-section",children:e.jsx(L,{emailLogin:u,onLoginSuccess:g})})]}),e.jsxs("div",{"data-testid":"signup-form-section",children:["New to untangled?"," ",e.jsx(v,{to:"/sign-up",className:"font-semibold",children:"Sign up"})]})]})})]})}export{T as default};
