import{ai as N,j as e,av as f,ar as g,r as h,an as v,aD as y,ae as I,A as k,g as D,a9 as _}from"./vendor-WQejLG7Y.js";import{a as w}from"./admin.service-hizXY1il.js";import{u as P,K as T}from"./kycProgress-CsJgu1it.js";import{d as A}from"./data.service-BjjAEJBf.js";import{N as E,n as u}from"./index-BUY2Cjej.js";import{u as B}from"./useAsync-Dl5FScg5.js";import{p as j}from"./pool.service-DXigxJcB.js";import{c as C}from"./index-YDRpzjTi.js";import{u as b}from"./useAsyncFn-DMoxp3xu.js";const F=({data:l})=>{var a,c,n;const{value:o}=B(async()=>(await A.getCountries()).reduce((r,m)=>(r[m.isoCode]=m.name,r),{}));if(!l)return null;const i=[{label:"Name",value:l==null?void 0:l.fullName},{label:"Date of birth",value:(l==null?void 0:l.dateOfBirth)&&N(l.dateOfBirth).format("DD/MM/YYYY")},{label:"Nationality",value:(()=>{const s=l==null?void 0:l.countryCitizenship;return s&&(o==null?void 0:o[s])||s})()},{label:"Address",value:(c=(a=l==null?void 0:l.identityVerificationData)==null?void 0:a.address)==null?void 0:c.full_address},{label:"Investor type",value:P[l==null?void 0:l.userType]??(l==null?void 0:l.userType)},{label:"ShuftiPro Ref. No",value:e.jsx(f,{children:l.reference})},((n=l==null?void 0:l.investorUids)==null?void 0:n.length)>0?{label:"Minted UIDs",value:(()=>{const s=l.investorUids;return e.jsx("div",{className:"flex flex-col gap-2",children:s.map(r=>{const m=E[r.chainId],t=r.status===1,x=r.status===2;return m?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:m.name}),e.jsxs("span",{children:[t&&e.jsx(f,{color:"green",children:"Minted"}),x&&e.jsx(f,{color:"error",children:"Burned"})]})]},r.id):null})})})()}:null].filter(Boolean);return e.jsxs("div",{className:"p-8 bg-pool-card-bg [&_label]:!h-4 [&_label]:!leading-0 [&_.ant-form-item]:!leading-4 rounded-3xl",children:[e.jsx("h2",{className:"text-2xl leading-8 mt-0 mb-4",children:"Profile"}),e.jsxs("div",{className:"flex gap-20",children:[e.jsx("div",{className:"flex flex-col gap-4 flex-1",children:i.map(({label:s,value:r})=>e.jsxs("div",{className:"flex gap-2 items-center text-sm",children:[e.jsx("span",{className:"text-[#5C615D] w-60",children:s}),e.jsx("span",{className:"font-semibold",children:r??"N/A"})]},s))}),e.jsx("div",{className:"flex-1",children:e.jsx(T,{investor:l})})]})]})},S=({address:l})=>{const[{value:o,loading:i},a]=b(async n=>{try{const s=await j.getPortfolioDetail(n),r=await Promise.all(s==null?void 0:s.investments.map(async t=>{const x=await C(t.tgeAddress);let d="0";try{const p=await x.methods.getTokenPrice().call();d=g(p||0,t.tokenDecimals)}catch(p){console.log("error get contract price",p)}return d}));return(s==null?void 0:s.investments.map((t,x)=>{const d=g(t.amount,t.tokenDecimals),p=parseFloat(r[x])*d;return{id:t.poolId,poolName:t.poolName,poolType:t.tokenName,total:d,price:r[x],token:p,tgeAddress:t.tgeAddress,event:t.event}}))??[]}catch(s){return console.log("Error when fetching portfolio:",s),[]}}),c=[{title:"Pool name",dataIndex:"poolName",key:"poolName",render:(n,s)=>s.poolName},{title:"Token",dataIndex:"token",key:"token",render:(n,s)=>e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("span",{children:`${u(s.total||0)}`}),e.jsxs("div",{className:"flex flex-row gap-2 items-center py-1 px-3 pl-2 bg-gray-100 rounded-lg",children:[e.jsx("img",{src:`https://investor-app.cdn.prismic.io/investor-app/${(s==null?void 0:s.poolType)==="SOT"?"f182437c-16b7-489a-a35c-f76b360263cd_sot.svg":"e2a8dc65-1d0c-4c69-976f-7d37cbc476b8_jot.svg"}`,width:"24"}),e.jsx("span",{children:`${s.event.ticker}_${s==null?void 0:s.poolType}`})]})]})},{title:"Price",dataIndex:"price",key:"price",render:(n,s)=>`${u(s.price)} ${s.event.currency.tokenSymbol}`},{title:"Balance",dataIndex:"balance",key:"balance",render:(n,s)=>`${u(s.token)} ${s.event.currency.tokenSymbol}`}];return h.useEffect(()=>{l&&a(l)},[l]),e.jsxs("div",{className:"p-8 bg-pool-card-bg [&_label]:!h-4 [&_label]:!leading-0 [&_.ant-form-item]:!leading-4 rounded-3xl mt-6",children:[e.jsx("h2",{className:"text-2xl leading-8 mt-0 mb-4",children:"Portfolio"}),i?e.jsx(v,{active:!0,loading:!0}):e.jsx("div",{className:"flex flex-col gap-4",children:o!=null&&o.length?e.jsx(y,{columns:c,dataSource:o,pagination:!1}):e.jsx("p",{children:"No investment found"})})]})},G=()=>{const{id:l,walletAddress:o}=I(),[{value:i,loading:a},c]=b(async()=>{let s;return l?s=await j.getPoolInvestorDetails(l,o):s=await w(o),s});h.useEffect(()=>{c()},[]);const n=i==null?void 0:i.data;return e.jsxs("div",{className:"max-w-screen-xl mx-auto space-y-6",children:[e.jsx("h1",{className:"m-0 text-4xl",children:"Investor Details"}),a?e.jsx(v,{active:!0,loading:!0}):e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex gap-8 items-center mb-6",children:[e.jsx(k,{size:64,icon:e.jsx(D,{})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"my-0 text-3xl",children:n==null?void 0:n.fullName}),e.jsx("span",{className:"text-sm  font-semibold",children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:"rounded-3xl p-8 bg-pool-card-bg bg-clip-padding mb-6",style:{border:"2px solid transparent",background:"linear-gradient(#f6f7f6, #f6f7f6) padding-box, linear-gradient(180deg, #21BFFA 0%, #1ED760 100%) border-box"},children:[e.jsx("h2",{className:"m-0 text-2xl font-semibold mb-4",children:"Wallet"}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 text-xs leading-4",children:"Wallet Address"}),e.jsx(_,{size:"large",readOnly:!0,value:(n==null?void 0:n.address)??"",className:"p-3"})]})]}),e.jsx(F,{data:n}),(n==null?void 0:n.address)&&e.jsx(S,{address:n.address})]})]})};export{G as default};
