import{r as a,ai as s,j as D,aP as I,S as c,aQ as M}from"./vendor-WQejLG7Y.js";import{p as j,R as N}from"./app-q0ws3Yx0.js";import{j as R}from"./index-YDRpzjTi.js";import{e as x,f as d}from"./index-BUY2Cjej.js";const k=({event:t})=>{const[r,e]=a.useState(new Date);a.useEffect(()=>{const f=setInterval(()=>{e(new Date)},6e4);return()=>clearInterval(f)},[]);const i=a.useMemo(()=>t.longSale&&t.status===2&&t.startEarningInterestTime?s(t.startEarningInterestTime).add(t.investmentTerms,"days"):t.closedAt||t.endTime,[t]);if(a.useMemo(()=>t.longSale&&t.status===j.eventStatuses.FINISHED?s(t.startEarningInterestTime).add(t.investmentTerms,"days")<s():t.status===j.eventStatuses.FINISHED||s(t.endTime)<=s(),[t]))return null;let u=s(i).diff(s(r),"days")+1+" days remaining";return s(i).diff(s(r),"days")<1&&(u=s(i).diff(s(r),"hours")+" hours remaining"),s(i).diff(s(r),"hours")<1&&(u=s(i).diff(s(r),"minutes")+" minutes remaining"),s(i).diff(s(r),"minutes")<=0&&(u=`Closed at ${s(i).format("HH:mm DD/MM/YYYY")}`),i?D.jsx("span",{className:"rounded-2xl inline-block px-3 py-1 bg-[#D4B106] font-semibold",children:D.jsx(I,{color:"rgba(254, 255, 230, 1)",text:u})}):null};function H({pool:t,event:r}){var y,S,O,A,o;const[e,i]=a.useState({}),[T,u]=a.useState(!1);a.useEffect(()=>{(async()=>{if(t!=null&&t.id&&(r!=null&&r.id)){u(!0);const n={poolContractAddress:t.poolContractAddress,saleEventAddress:r.saleEventAddress,juniorSaleEventAddress:r.juniorSaleEventAddress,jotTokenAddress:r.juniorNotesTokenAddress,sotTokenAddress:r.notesTokenAddress};try{const m=await R(n),C=x(m);i(C)}catch(m){console.log("---> error",{e:m,params:n})}u(!1)}})()},[r,t]);const f=a.useMemo(()=>{var n;return e.sotTargetAmount||e.jotTargetAmount?d(new c(e.sotTargetAmount).plus(e.jotTargetAmount),((n=t==null?void 0:t.currency)==null?void 0:n.decimals)||18):0},[(y=t==null?void 0:t.currency)==null?void 0:y.decimals,e.jotTargetAmount,e.sotTargetAmount]),g=a.useMemo(()=>{var n;return M(e.poolValueAssets)?0:d(new c(e.poolValueAssets).plus(e.poolReserve),((n=t==null?void 0:t.currency)==null?void 0:n.decimals)||18)},[(S=t==null?void 0:t.currency)==null?void 0:S.decimals,e.poolReserve,e.poolValueAssets]),l=a.useMemo(()=>{var n;if(e.investmentCapacityOfSOT||e.investmentCapacityOfJOT){const m=new c(e.investmentCapacityOfJOT?e.investmentCapacityOfJOT.toString():0);return new c(e.investmentCapacityOfSOT?e.investmentCapacityOfSOT.toString():0).plus(m).dividedBy(new c(10).pow(((n=t==null?void 0:t.currency)==null?void 0:n.decimals)||18)).toNumber()}return 0},[(O=t==null?void 0:t.currency)==null?void 0:O.decimals,e.investmentCapacityOfJOT,e.investmentCapacityOfSOT]),E=a.useMemo(()=>{var n;return e.totalSupplyOfJOT||e.totalSupplyOfSOT?d(new c(e.totalSupplyOfJOT).plus(e.totalSupplyOfSOT),((n=t==null?void 0:t.currency)==null?void 0:n.decimals)||18):0},[(A=t==null?void 0:t.currency)==null?void 0:A.decimals,e.totalSupplyOfJOT,e.totalSupplyOfSOT]),w=a.useMemo(()=>(t==null?void 0:t.interestRateSot)&&Number(t.interestRateSot)/N||0,[t==null?void 0:t.interestRateSot]),b=a.useMemo(()=>{var n;return d(new c(e.getSeniorDebt||0).minus(e.getBeginningSeniorDebt||0),(n=t==null?void 0:t.currency)==null?void 0:n.decimals)},[(o=t==null?void 0:t.currency)==null?void 0:o.decimals,e.getBeginningSeniorDebt,e.getSeniorDebt]);return{poolData:e,targetAmount:f,poolValue:g,remainingAmount:l,projectedAPY:w,outstandingAmount:E,couponAPR:b,loadingPoolData:T}}export{k as C,H as u};
